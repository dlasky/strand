<!DOCTYPE html>
<html>
	<head>
		<script language="javascript" src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
		<link rel="import" href="../strand-input/strand-input.html" />
		<link rel="import" href="../strand-dropdown/strand-dropdown.html" />
		<link rel="import" href="../strand-list-item/strand-list-item.html" />
		<link rel="import" href="../strand-highlight/strand-highlight.html" />
		<link rel="import" href="strand-item-recycler.html" />
			<style type="text/css">
			html, body {
				padding: 0;
				margin: 0;
				background: #eee;
			}

			strand-item-recycler[unresolved] {
				display: none;
			}

			strand-item-recycler {
				height: 500px;
				padding-top: 10px;
			}
		</style>
	</head>
	<body>
	
	<button id="switch">toggle</button>

	<div id="toggle">

		<!-- as of Polymer 2.0 preview - URI import still has some issues: the original 'onload' event is lost -->
		<!-- https://github.com/Polymer/polymer/blob/2.0-preview/src/utils/utils.html#L160 -->
		<!-- 
		<strand-item-recycler id="itemRecycler" template-uri="template.html" unresolved>
			<div slot="header" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Header<br/>Text</div>
			<div slot="footer" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Footer<br/>Text<br/>Too</div>
			Hello World
		</strand-item-recycler>
		-->

		<strand-item-recycler id="itemRecycler2" unresolved>
			<div slot="header" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Header<br/>Text</div>
			<div slot="footer" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Footer<br/>Text<br/>Too</div>
			<template slot="template">
				<div data-id="{{model.id}}" style$="{{model.style}}">
					<span>{{model.num}}</span>
					<strand-input value="{{model.name}}"></strand-input>
				</div>
			</template>
		</strand-item-recycler>

		<strand-item-recycler id="itemRecycler3" unresolved>
			<div slot="header" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Header<br/>Text</div>
			<div slot="footer" style="font-family: sans-serif; font-size: 13px; background: #ccc; padding:5px;">Footer<br/>Text<br/>Too</div>
			Hello World
			<template slot="template">
				<div data-id="{{model.id}}" style$="{{model.style}}">
					<span>{{model.num}}</span>
					<strand-input value="{{model.name}}"></strand-input>
				</div>
			</template>
		</strand-item-recycler>


		<!-- more simple test case -->
		<!--
		<strand-item-recycler
			id="listItemRecycler">
			<template slot="template">
				<strand-list-item
					value$="{{model.value}}"
					selected$="{{model.selected}}"
					highlighted$="{{model.highlighted}}"
					show-placeholder="{{!model}}">
					<template is="dom-if" if="{{model}}">
						<strand-highlight 
							text="{{model.name}}" 
							highlight="{{scope.highlight}}">
						</strand-highlight>
					</template>
				</strand-list-item>
			</template>
		</strand-item-recycler>
		--> 

	</div>
	

	<script type="text/javascript">

		var data = [],
			ddDataArr = [],
			listItems = [],
			itemRecycler,
			header,
			mmItemStyleStr = 'font-family: sans-serif; font-size: 13px; background: #fff; border-bottom: 1px solid #ccc; padding: 10px;',
			NUM_ITEMS = 300;

		for(var i=0; i<NUM_ITEMS; i++) {
			generateItem(i);
		}

		for(var j=0; j<50; j++) {
			ddDataArr.push({
				name: "Some Name " + j,
				value: "String" + j
			});
		}

		for (var i=0; i < 100; i++) {
			listItems.push({ value: String(i), name: "No." + i + " Readable Very Long Name Here" });
		}

		function generateItem(index) {
			data.push({
				num: index,
				id: i,
				name: Math.random().toString(36).substring(7),
				advertiser: "Advertiser No. " + i,
				concept: "Concept No. " + i,
				type: "swf",
				file: "Creative_File_" + i + ".swf",
				dimensions: String(Math.floor(Math.random()*300) + " x " + Math.floor(Math.random()*300)),
				style: index < 12 ? mmItemStyleStr : mmItemStyleStr + "height: 90px",
				size: 50,
				dd:{
					dropdownData: ddDataArr,
					dropDownValue: "String15"
				}
			});
		}

		window.addEventListener("WebComponentsReady", function() {
			
			var all = [
				document.querySelector("#itemRecycler"),
				document.querySelector("#itemRecycler2"),
				document.querySelector("#itemRecycler3"),
			];

			toggle = document.querySelector("#toggle");
			// itemRecycler = all[0];
			// (itemRecycler || {}).data = data;
			itemRecycler = all[1];
			(itemRecycler || {}).data = data;
			itemRecycler = all[2];
			(itemRecycler || {}).data = data;

			// var listItemRecycler = document.querySelector('#listItemRecycler');
			// listItemRecycler.data = listItems;

			document.querySelector("#switch").onclick = function () {
				if (toggle.style.display !== "none") {
					toggle.style.display = "none"
				} else {
					toggle.style.display = "block";
					// all.forEach(function (recycler) {
					// 	recycler && recycler.initialize();
					// });
				}
			};

			// setTimeout(function () {
			// 	//itemRecycler.data = data.slice(data.length >> 2, data.length >> 1);
			// }, 3000);

			// /*
			// setTimeout(function () {
			// 	itemRecycler.style.height = (2 * itemRecycler.offsetHeight) + "px";

			// 	(function loop () {
			// 		var index = 0|(Math.random() * itemRecycler.data.length);
			// 		var datum = itemRecycler.data[index];
			// 		if (datum.size === 50) {
			// 			datum.size = 100;
			// 			itemRecycler.set("data."+index+".style", "transition: height 2s; height: 100px");
			// 		} else {
			// 			datum.size = 50;
			// 			itemRecycler.set("data."+index+".style", "transition: height 2s; height: 50px");
			// 		}
			// 		setTimeout(loop, 1000);
			// 	});
			// }, 3000);
			// */

		});
	</script>
	</body>
</html>